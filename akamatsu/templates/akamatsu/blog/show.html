{% extends "akamatsu/layout.html" %}
{% from "akamatsu/_macros.html" import render_comments, show_author, show_bio, show_tags %}

{% block title %}{{ post.title }}{% endblock %}

{% block head_extend %}
    {# Keywords #}
    <meta name="keywords" content="{{ post.tags|map(attribute='name')|join(', ') }}"/>

    {# Author name (or username) #}
    {% set author = "%(name)s %(lastname)s"|format(name=post.author.first_name, lastname=post.author.last_name)|trim %}
    {% if author %}
        <meta name="author" content="{{ author }}"/>
    {% else %}
        <meta name="author" content="post.author.username"/>
    {% endif %}
{% endblock %}

{# Page mini #}
{% block mini %}.blog{% endblock %}

{# Post content #}
{% block content %}

<div class="grid grid-pad">
    <article class="aka-post col-1-1">
        <h2 class="title">{{ post.title }}</h2>

        <div class="author">
            {{ show_author(post) }}
        </div>

        <span class="date">
            {{ post.timestamp.strftime('%d %b %Y') }}
        </span>

        <div class="content">
            {{ post.content|markdown }}
        </div>

        <p class="tags">
            {{ show_tags(post) }}
        </p>

        <div class="bio">
            {{ show_bio(post) }}
        </div>
    </article>
</div>

<div class="grid grid-pad">
    <section id="comments">
        {% if post.comments_enabled %}
            {{ render_comments(post, 'post', 'blog.show') }}
        {% endif %}
    </section>
</div>

{% endblock %}
