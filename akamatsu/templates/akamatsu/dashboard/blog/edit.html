{% extends "akamatsu/dashboard/layout.html" %}
{% from "akamatsu/_macros.html" import render_field, render_checkbox_field, render_submit_field, render_success_msg, render_warning_msg %}

{% block custom_header %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
    <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
{% endblock %}

{% block title %}Post editor{% endblock %}
{% block mini %}.blog{% endblock %}

{# Post editor #}
{% block content %}

{% if status == 'error' %}
    {{ render_warning_msg(errmsg) }}
{% else %}


{# Status #}
{% if status == 'saveerror' %}
    {{ render_warning_msg(errmsg) }}
{% endif %}

{% if status == 'saved' %}
    {{ render_success_msg('Post saved correctly') }}
{% endif %}


{# Delete button #}
{% if mode == 'edit' %}
<div class="grid grid-pad">
    <div class="col-2-12 push-right">
        <a href="{{ url_for('dashboard.blog_delete', post_id=post_id) }}" class="aka-btn-warning plainlink">
            <i class="fa fa-trash"></i> Delete post
        </a>
    </div>
</div>
{% endif %}


<form action="" method="POST" role="form">
    {{ form.hidden_tag() }}


    {{ render_field(form.title) }}

    {{ render_field(form.content) }}

    {{ render_field(form.ghost) }}

    {{ render_field(form.slug) }}

    {{ render_field(form.author_name) }}

    {{ render_field(form.tag_list) }}

    <div class="grid grid-pad">
        <div class="col-1-5">
            {{ render_checkbox_field(form.is_published) }}
        </div>
        <div class="col-1-5">
            {{ render_checkbox_field(form.comments_enabled) }}
        </div>
    </div>

    {{ render_field(form.timestamp, is_date=true) }}


    <div class="grid grid-pad">
        <div class="col-1-3 push-1-3">
            <input type="submit" class="aka-btn-primary" value="Save">
        </div>
    </div>
</form>
{% endif %}

{% endblock %}
